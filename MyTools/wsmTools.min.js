function randomColor(){var t=Math.floor(Math.random()*256);var e=Math.floor(Math.random()*256);var i=Math.floor(Math.random()*256);return"rgb("+t+","+e+","+i+")"}function randomWord(){var t=Array("a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","G","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z");var e=Math.floor(Math.random()*52);return t[e]}function randomNumber(){var t=Array(0,1,2,3,4,5,6,7,8,9);var e=Math.floor(Math.random()*10);return t[e]}function formatDate(t){return t<10?"0"+t:t}Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"f+":this.getMilliseconds()};if(/(y+)/.test(t))t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));for(var i in e)if(new RegExp("("+i+")").test(t))t=t.replace(RegExp.$1,RegExp.$1.length==1?e[i]:("00"+e[i]).substr((""+e[i]).length));return t};function addOnloadEvent(t){var e=window.onload;if(typeof window.onload!="function"){window.onload=t}else{if(e){e()}t()}}Object.prototype.insertAfter=function(t,e){var i=e.nextElementSibling;if(i==null){this.appendChild(t)}else{this.insertBefore(t,i)}};function stopBubble(t){if(t.stopPropagation){t.stopPropagation()}else{t.cancelBubble=true}}function getStyle(t,e){if(window.getComputedStyle){return window.getComputedStyle(t,null)[e]}else{return t.currentStyle[e]}}function cancelHandler(t){if(t.preventDefault){t.preventDefault()}else{t.returnValue=false}}function addEvent(t,e,i){if(t.addEventListener){t.addEventListener(e,i,false)}else if(t.attachEvent){t.attachEvent("on"+e,function(){i.call(t)})}else{t["on"+e]=i}}function removeEvent(t,e,i){if(t.addEventListener){t.removeEventListener(e,i,false)}else if(t.attachEvent){t.detachEvent("on"+e,function(){i.call(t)})}}function draft(e,i,o){var n,r;addEvent(e,"mousedown",function(t){if(i){i.style.cursor="move"}if(o){o.style.cursor="move"}e.style.cursor="move";n=t.pageX-parseInt(getStyle(e,"left"));r=t.pageY-parseInt(getStyle(e,"top"));addEvent(document,"mousemove",a);addEvent(document,"mouseup",s)});function a(t){var t=t||window.event;e.style.left=t.pageX-n+"px";e.style.top=t.pageY-r+"px"}function s(t){removeEvent(document,"mousemove",a);e.style.cursor="default";if(i){i.style.cursor="default"}if(o){o.style.cursor="default"}}}function getNodeText(t){if(window.ActiveXObject){return t.text}else{if(t.nodeType==1){return t.textContent}}}function Ajax(e){var i=null;if(window.XMLHttpRequest){i=new XMLHttpRequest}else{i=new ActiveXObject("Microsoft.XMLHTTP")}var t=e.type=="get"?"get":"post";var o=e.asyn=="true"?"true":"false";if(t=="get"){var n=e.url+"?"+e.data+"&_t="+(new Date).getTime();i.open(t,n,o);i.send(null)}else if(t=="post"){i.setRequestHeader("Content-Type","application/-form-urlencoded");i.send(e.data)}i.onreadystatechange=function(){if(i.readyState==4&&i.status==200){if(typeof e.success=="function"){var t=e.dataType=="xml"?i.responseXML:i.responseText;e.success(t)}else if(typeof e.failure=="function"){e.failure()}}}}function judgeDirection(t){var e=$(this).width();var i=$(this).height();var o=(t.pageX-this.offsetLeft-e/2)*(e>i?i/e:1);var n=(t.pageY-this.offsetTop-i/2)*(i>e?e/i:1);var r=Math.round((Math.atan2(n,o)*(180/Math.PI)+180)/90+3)%4;var a=new Array("On the top side ","On the right side ","On the bottom side ","On the left side ");if(t.type=="mouseenter"){$(this).html(a[r]+"in")}else{$(this).html(a[r]+"out")}}function Hero(t){this._init(t)}Hero.prototype={_init:function(t){this.x=t.x||0;this.y=t.y||0;this.w=t.w||40;this.h=t.h||65;this.originW=t.originW||40;this.originH=t.originH||65;this.speed=t.speed||5;this.imgSrc=t.imgSrc||"";this._direction=0},render:function(e){var i=new Image;i.src=this.imgSrc;var o=this;i.onload=function(){var t=0;setInterval(function(){e.clearRect(0,100,e.canvas.width,e.canvas.height);e.drawImage(i,t*o.originW,o._direction*o.originH,o.originW,o.originH,o.x,o.y,o.w,o.h);t++;t%=4},1e3/o.speed)}},changeDirection:function(t){if(t=="left"){this._direction=1}if(t=="right"){this._direction=2}if(t=="top"){this._direction=3}if(t=="bottom"){this._direction=0}}};function wsmRect(t){this._init(t)}wsmRect.prototype={_init:function(t){this.x=t.x===0?0:t.x||10;this.y=t.y===0?0:t.y||10;this.w=t.w||100;this.h=t.h||100;this.strokeColor=t.strokeColor||"#000";this.fillColor=t.fillColor||"lightblue";this.rotate=t.rotate||0;this.scaleX=t.scaleX||1;this.scaleY=t.scaleY||1;this.opacity=t.opacity===0?0:t.opacity||1;this.aroundSelf=t.aroundSelf||false;this.perClear=t.perClear||false},render:function(t){t.save();t.beginPath();this.perClear==true?t.clearRect(0,0,t.canvas.width,t.canvas.height):t.clearRect(0,0,0,0);t.scale(this.scaleX,this.scaleY);t.rotate(this.rotate*Math.PI/180);t.globalAlpha=this.opacity;t.scale(this.scaleX,this.scaleY);this.aroundSelf==true?t.rect(0,0,this.w,this.h):t.rect(this.x,this.y,this.w,this.h);t.strokeStyle=this.strokeColor;t.stroke();t.fillStyle=this.fillColor;t.fill();t.restore()}};function wsmCircle(t){this._init(t)}wsmCircle.prototype={_init:function(t){this.x=t.x===0?0:t.x||100;this.y=t.y===0?0:t.y||100;this.r=t.r||100;this.startAngle=t.startAngle<=0?t.startAngle:t.startAngle||-90;this.endAngle=t.endAngle<=0?t.endAngle:t.endAngle||30;this.strokeColor=t.strokeColor||"#000";this.fillColor=t.fillColor||"lightblue";this.scaleX=t.scaleX||1;this.scaleY=t.scaleY||1;this.opacity=t.opacity===0?0:t.opacity||1;this.perClear=t.perClear||false;this.isStroke=t.isStroke||false},render:function(t){t.save();t.scale(this.scaleX,this.scaleY);t.globalAlpha=this.opacity;t.moveTo(this.x,this.y);t.arc(this.x,this.y,this.r,this.startAngle*Math.PI/180,this.endAngle*Math.PI/180);if(this.isStroke){t.strokeStyle=this.strokeColor;t.stroke()}t.fillStyle=this.fillColor;t.fill();t.closePath();t.restore()}};function wsmProgressBar(t){this._init(t)}wsmProgressBar.prototype={_init:function(t){this.x=t.x||100;this.y=t.y||100;this.w=t.w||100;this.h=t.h||50;this.fillColor=t.fillColor==null?"orange":t.fillColor;this.strokeColor=t.strokeColor==null?"blue":t.strokeColor;this.strokeWidth=t.strokeWidth==null?"4":t.strokeWidth;var e=new Konva.Rect({x:this.x,y:this.y,width:1/10*this.w,height:this.h,fill:this.fillColor,cornerRadius:1/2*this.h,id:"innerRect"});var i=new Konva.Rect({x:this.x,y:this.y,width:this.w,height:this.h,stroke:this.strokeColor,strokeWidth:this.strokeWidth,cornerRadius:1/2*this.h});this.group=new Konva.Group({});this.group.add(e);this.group.add(i)},changeValue:function(t){if(t>1){t=t/100}var e=this.w*t;var i=this.group.findOne("#innerRect");i.to({width:e,duration:3,easing:Konva.Easings.StrongEaseInOut})},addToGroupOrLayer:function(t){t.add(this.group)}};function wsmCircleRing(t){this._init(t)}wsmCircleRing.prototype={_init:function(t){this.x=t.x||0;this.y=t.y||0;this.innerRadius=t.innerRadius||0;this.outerRadius=t.outerRadius||0;this.text=t.text||"Konva";this.innerColor=t.innerColor||"lightblue";this.outerColor=t.outerColor||"#e1e1e1";this.align=t.align==null?"center":t.align;this.fontSize=t.fontSize||15;this.textColor=t.textColor==null?"#fff":t.textColor;this.isBold=t.isBold==true?"bold":"normal";this.opacity=t.opacity||1;this.group=new Konva.Group({x:this.x,y:this.y});var e=new Konva.Circle({x:0,y:0,radius:this.innerRadius,fill:this.innerColor,opacity:this.opacity});this.group.add(e);var i=new Konva.Ring({x:0,y:0,innerRadius:this.innerRadius,outerRadius:this.outerRadius,fill:this.outerColor,opacity:this.opacity});this.group.add(i);var o=new Konva.Text({x:0-this.outerRadius,y:-7,fill:this.textColor,text:this.text,width:this.outerRadius*2,fontSize:this.fontSize,align:this.align,fontStyle:this.isBold});this.group.add(o)},addToGroupOrLayer:function(t){t.add(this.group)}};function wsmHistogram(t){this._init(t)}wsmHistogram.prototype={_init:function(t){this.x=t.x||0;this.y=t.y||0;this.w=t.w||0;this.h=t.h||0;this.data=t.data||[];this.allGroup=new Konva.Group({x0:this.x,y0:this.y});this.rectGroup=new Konva.Group({x:0,y:0});this.allGroup.add(this.rectGroup);this.percentTextGroup=new Konva.Group({x:0,y:0});this.allGroup.add(this.percentTextGroup);var e=new Konva.Line({points:[x0,y0,x0+this.w,y0],strokeWidth:1,stroke:"lightgreen"});this.allGroup.add(e);var a=this.h;var s=this.w/this.data.length;var h=this;this.data.forEach(function(t,e){var i=new Konva.Rect({x:x0+(e+1/4)*s,y:y0-t.value*a,width:1/2*s,height:t.value*a,fill:t.color,opacity:.9,cornerRadius:10,name:"rect",shadowBlur:10,shadowColor:"black"});h.rectGroup.add(i);var o=new Konva.Text({x:x0+e*s,y:y0-t.value*a-14,fontSize:14,width:s,align:"center",text:t.value*100+"%",fill:t.color,name:"percentText"});h.percentTextGroup.add(o);var n=new Konva.Group({x:x0+(e+2/5)*s,y:y0});var r=new Konva.Text({x:0,y:0,fontSize:14,align:"center",text:t.name,fill:t.color,rotation:30});n.add(r);h.allGroup.add(n)})},addToGroupOrLayer:function(t){t.add(this.allGroup)},playAnimation:function(){var i=this;this.rectGroup.find("Rect").each(function(t,e){t.y(y0);t.height(0);t.to({duration:1,y:y0-i.data[e].value*height,height:i.data[e].value*height})});this.percentTextGroup.find("Text").each(function(t,e){t.y(y0-14);t.to({duration:1,y:y0-i.data[e].value*height-14})})}};function wsmPie(t){this._init(t)}wsmPie.prototype={_init:function(t){this.x=t.x||0;this.y=t.y||0;this.r=t.r||0;this.data=t.data||[];this.fontSize=t.fontSize||14;this.circleR=t.circleR||8;this.textR=t.textR||20;this.strokeColor=t.strokeColor||"#ccc";this._animationIndex=0;this.group=new Konva.Group({x:this.x,y:this.y});this.pieGroup=new Konva.Group({x:0,y:0});this.textGroup=new Konva.Group({x:0,y:0});this.group.add(this.pieGroup);this.group.add(this.textGroup);var a=-90,s=this;this.data.forEach(function(t,e){var i=t.value*360,o=a+1/2*i;var n=new Konva.Wedge({x:0,y:0,radius:s.r,angle:i,fill:t.color,rotation:a});s.pieGroup.add(n);var r=new Konva.Text({x:(s.r+s.textR)*Math.cos(o*Math.PI/180),y:(s.r+s.textR)*Math.sin(o*Math.PI/180),fill:t.color,text:t.name+":"+t.value*100+"%",fontSize:s.fontSize});if(o>90&&o<270){r.x(r.x()-r.width())}s.textGroup.add(r);a+=t.value*360});var e=new Konva.Circle({x:0,y:0,radius:this.r+this.circleR,stroke:this.strokeColor});this.group.add(e)},addToGroupOrLayer:function(t){t.add(this.group)},playAnimation:function(t){var e=this;if(this._animationIndex==0){this.pieGroup.getChildren().each(function(t,e){t.angle(0)})}var i=this.pieGroup.getChildren()[this._animationIndex];i.to({duration:this.data[e._animationIndex].value*t,angle:this.data[e._animationIndex].value*360,onFinish:function(){e._animationIndex++;if(e._animationIndex>=e.data.length){e._animationIndex=0;return}e.playAnimation(t)}})}};